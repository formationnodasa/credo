<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dict√©e Interactive</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(270deg, #6a11cb, #2575fc, #6a11cb);
      background-size: 600% 600%;
      animation: gradientAnimation 15s ease infinite;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }

    @keyframes gradientAnimation {
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }

    .container {
      background: rgba(255,255,255,0.1);
      padding: 30px;
      border-radius: 16px;
      max-width: 700px;
      width: 100%;
      text-align: center;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0,0,0,0.25);
    }

    h1 {
      margin-bottom: 20px;
      font-size: 1.8rem;
    }

    select, textarea, button {
      width: 100%;
      margin-top: 12px;
      padding: 12px;
      font-size: 1rem;
      border-radius: 8px;
      border: none;
      outline: none;
    }

    textarea {
      height: 180px;
      resize: vertical;
      background: rgba(255,255,255,0.9);
      color: #333;
    }

    select {
      background: rgba(255,255,255,0.9);
      color: #333;
    }

    .buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
    }

    .buttons button {
      flex: 1 1 calc(50% - 10px);
      background: #fff;
      color: #2575fc;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s;
    }

    .buttons button:hover {
      background: #2575fc;
      color: #fff;
    }

    #result {
      margin-top: 15px;
      font-weight: bold;
      min-height: 1.2em;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>

  <div class="container">
    <h1>üìú Dict√©e Interactive</h1>

    <select id="dictationSelect">
      <option value="laboureur">Le laboureur et ses enfants</option>
      <option value="cigale">La Cigale et la Fourmi</option>
    </select>

    <div class="buttons">
      <button onclick="playDictation()">‚ñ∂Ô∏è √âcouter</button>
      <button onclick="togglePause()">‚è∏Ô∏è Pause / Reprendre</button>
      <button onclick="slowDown()">üê¢ Ralentir</button>
      <button onclick="speedUp()">üêá Acc√©l√©rer</button>
      <button onclick="checkDictation()">‚úÖ V√©rifier</button>
    </div>

    <textarea id="userInput" placeholder="√âcris ici ta dict√©e..."></textarea>

    <div id="result"></div>
  </div>


  <script>
    const dictations = {
      laboureur: `Travaillez, prenez de la peine :\nC'est le fonds qui manque le moins.\nUn riche Laboureur, sentant sa mort prochaine,\nFit venir ses enfants, leur parla sans t√©moins.\nGardez-vous, leur dit-il, de vendre l'h√©ritage\nQue nous ont laiss√© nos parents.\nUn tr√©sor est cach√© dedans.\nJe ne sais pas l'endroit ; mais un peu de courage\nVous le fera trouver, vous en viendrez √† bout.\nRemuez votre champ d√®s qu'on aura fait l'O√ªt.\nCreusez, fouillez, b√™chez ; ne laissez nulle place\nO√π la main ne passe et repasse.\nLe p√®re mort, les fils vous retournent le champ\nDe√ß√†, del√†, partout ; si bien qu'au bout de l'an\nIl en rapporta davantage.\nD'argent, point de cach√©. Mais le p√®re fut sage\nDe leur montrer avant sa mort\nQue le travail est un tr√©sor.`,

      cigale: `La Cigale, ayant chant√© Tout l'√©t√©,\nSe trouva fort d√©pourvue Quand la bise fut venue :\nPas un seul petit morceau De mouche ou de vermisseau.\nElle alla crier famine Chez la Fourmi sa voisine,\nLa priant de lui pr√™ter Quelque grain pour subsister\nJusqu'√† la saison nouvelle. ¬´ Je vous paierai, lui dit-elle,\nAvant l'ao√ªt, foi d'animal, Int√©r√™t et principal. ¬ª\nLa Fourmi n'est pas pr√™teuse : C'est l√† son moindre d√©faut.\n¬´ Que faisiez-vous au temps chaud ? Dit-elle √† cette emprunteuse.\n‚Äî Nuit et jour √† tout venant Je chantais, ne vous d√©plaise.\n‚Äî Vous chantiez ? j'en suis fort aise ; Eh bien dansez maintenant. ¬ª`
    };

Li√®vre: `Tout le monde savait que le Li√®vre √©tait l'animal le plus rapide, et le Li√®vre adorait s'en vanter. ¬´ Jamais un animal n'a √©t√©, n'est ou ne sera aussi rapide que moi, clamait-il. Personne ne peut me battre ! ¬ª
Un jour de grande chaleur, le Li√®vre cherchait quelqu'un pour faire la course, tout en fanfaronnant se vantant, comme √† son habitude. Il rencontra la Tortue qui passait par l√† de son pas lent. Elle accepta le d√©fi que lui proposa le Li√®vre.
Ils demand√®rent √† la Chouette de donner le signal : il fallait faire le tour du parc et revenir au point de d√©part. La Chouette hulula signifiant ainsi le d√©but de la course. Le Li√®vre fut bient√¥t arriv√© √† mi-parcours. Alors, il s'arr√™ta pour d√©jeuner. La Tortue, loin derri√®re, continuait de son pas lent.
Comme il ne voyait pas venir la Tortue, le Li√®vre fit une petite sieste. La Tortue poursuivit son chemin pesamment.
Le Li√®vre dormit tout l'apr√®s-midi. Quand il s'√©veilla, il aper√ßut la Tortue, au loin, qui s'approchait lentement de la ligne d'arriv√©e. Pour essayer de rattraper la Tortue, le Li√®vre d√©tala si bien qu'on distinguait √† peine ses pattes et que ses longues oreilles √©taient rabattues en arri√®re. Mais il arriva trop tard. C'est la Tortue qui remporta la course...d'une encolure.
En gardant une allure constante.`
    };


Li√®vre: `Tout le monde savait que le Li√®vre √©tait l'animal le plus rapide, et le Li√®vre adorait s'en vanter. ¬´ Jamais un animal n'a √©t√©, n'est ou ne sera aussi rapide que moi, clamait-il. Personne ne peut me battre ! ¬ª
Un jour de grande chaleur, le Li√®vre cherchait quelqu'un pour faire la course, tout en fanfaronnant se vantant, comme √† son habitude. Il rencontra la Tortue qui passait par l√† de son pas lent. Elle accepta le d√©fi que lui proposa le Li√®vre.
Ils demand√®rent √† la Chouette de donner le signal : il fallait faire le tour du parc et revenir au point de d√©part. La Chouette hulula signifiant ainsi le d√©but de la course. Le Li√®vre fut bient√¥t arriv√© √† mi-parcours. Alors, il s'arr√™ta pour d√©jeuner. La Tortue, loin derri√®re, continuait de son pas lent.
Comme il ne voyait pas venir la Tortue, le Li√®vre fit une petite sieste. La Tortue poursuivit son chemin pesamment.
Le Li√®vre dormit tout l'apr√®s-midi. Quand il s'√©veilla, il aper√ßut la Tortue, au loin, qui s'approchait lentement de la ligne d'arriv√©e. Pour essayer de rattraper la Tortue, le Li√®vre d√©tala si bien qu'on distinguait √† peine ses pattes et que ses longues oreilles √©taient rabattues en arri√®re. Mais il arriva trop tard. C'est la Tortue qui remporta la course...d'une encolure.
En gardant une allure constante.`
    };



Le corbeau et le renard: `Ma√Ætre Corbeau, sur un arbre perch√©,
Tenait en son bec un fromage.
Ma√Ætre Renard, par l'odeur all√©ch√©,
Lui tint √† peu pr√®s ce langage¬†:
Et bonjour, Monsieur du Corbeau.
Que vous √™tes joli¬†! que vous me semblez beau¬†!
Sans mentir, si votre ramage
Se rapporte √† votre plumage,
Vous √™tes le Ph√©nix des h√¥tes de ces bois.
√Ä ces mots, le Corbeau ne se sent pas de joie¬†;
Et pour montrer sa belle voix,
Il ouvre un large bec, laisse tomber sa proie.
Le Renard s'en saisit, et dit¬†: Mon bon Monsieur,
Apprenez que tout flatteur
Vit aux d√©pens de celui qui l'√©coute.
Cette le√ßon vaut bien un fromage, sans doute.
Le Corbeau honteux et confus
Jura, mais un peu tard, qu'on ne l'y prendrait plus.`
    };


Grenouille: `Une Grenouille vit un b≈ìuf
Qui lui sembla de belle taille.
Elle qui n'√©tait pas grosse en tout comme un ≈ìuf,
Envieuse s'√©tend, et s'enfle, et se travaille
Pour √©galer l'animal en grosseur,
Disant¬†: Regardez bien, ma s≈ìur¬†;
Est-ce assez¬†? dites-moi¬†; n'y suis-je point encore¬†?
‚Äî¬†Nenni. ‚Äî¬†M'y voici donc¬†? ‚Äî¬†Point du tout. ‚Äî¬†M'y voil√†¬†?
‚Äî¬†Vous n'en approchez point. La ch√©tive p√©core
S'enfla si bien qu'elle creva.
Le monde est plein de gens qui ne sont pas plus sages¬†:
Tout Bourgeois veut b√¢tir comme les grands Seigneurs,
Tout petit Prince a des Ambassadeurs,
Tout Marquis veut avoir des Pages.`
    };



Fourmi: `Nous √©tions au milieu de l'hiver, un jour clair et glacial. Malgr√© le froid, la Fourmi se chauffait au soleil. Elle m√¢chonnait quelques graines provenant d'un gros tas qu'elle avait p√©niblement ¬´ amoncel√© ¬ª tout au long de l'√©t√©.
Tandis que la Fourmi mangeait, la Sauterelle arriva, son estomac criant famine. S'adressant √† la Fourmi, elle qu√©manda une ou deux graines.
¬´ Eh bien, demanda la Fourmi, que faisiez-vous durant l'√©t√© ? ¬ª
¬´ Je sautais de feuille en feuille, je les mordillais, je chantais ¬ª, r√©pliqua la Sauterelle.
¬´ Vous n'avez rien mis de c√¥t√© en pr√©vision de l'hiver ? ¬ª interrogea la Fourmi.
La Sauterelle secoua la t√™te tristement.
¬´Toutes les m√™mes, ces sauterelles¬ª, dit la Fourmi. Puis elle donna quelques graines √† la Sauterelle, et la renvoya avec ces mots :
¬´ Ceux qui ne travaillent pas en √©t√© auront faim en hiver. ¬ª`
    };
7.



Fourmi: `Nous √©tions au milieu de l'hiver, un jour clair et glacial. Malgr√© le froid, la Fourmi se chauffait au soleil. Elle m√¢chonnait quelques graines provenant d'un gros tas qu'elle avait p√©niblement ¬´ amoncel√© ¬ª tout au long de l'√©t√©.
Tandis que la Fourmi mangeait, la Sauterelle arriva, son estomac criant famine. S'adressant √† la Fourmi, elle qu√©manda une ou deux graines.
¬´ Eh bien, demanda la Fourmi, que faisiez-vous durant l'√©t√© ? ¬ª
¬´ Je sautais de feuille en feuille, je les mordillais, je chantais ¬ª, r√©pliqua la Sauterelle.
¬´ Vous n'avez rien mis de c√¥t√© en pr√©vision de l'hiver ? ¬ª interrogea la Fourmi.
La Sauterelle secoua la t√™te tristement.
¬´Toutes les m√™mes, ces sauterelles¬ª, dit la Fourmi. Puis elle donna quelques graines √† la Sauterelle, et la renvoya avec ces mots :
¬´ Ceux qui ne travaillent pas en √©t√© auront faim en hiver. ¬ª`
    };


Fourmi: `Nous √©tions au milieu de l'hiver, un jour clair et glacial. Malgr√© le froid, la Fourmi se chauffait au soleil. Elle m√¢chonnait quelques graines provenant d'un gros tas qu'elle avait p√©niblement ¬´ amoncel√© ¬ª tout au long de l'√©t√©.
Tandis que la Fourmi mangeait, la Sauterelle arriva, son estomac criant famine. S'adressant √† la Fourmi, elle qu√©manda une ou deux graines.
¬´ Eh bien, demanda la Fourmi, que faisiez-vous durant l'√©t√© ? ¬ª
¬´ Je sautais de feuille en feuille, je les mordillais, je chantais ¬ª, r√©pliqua la Sauterelle.
¬´ Vous n'avez rien mis de c√¥t√© en pr√©vision de l'hiver ? ¬ª interrogea la Fourmi.
La Sauterelle secoua la t√™te tristement.
¬´Toutes les m√™mes, ces sauterelles¬ª, dit la Fourmi. Puis elle donna quelques graines √† la Sauterelle, et la renvoya avec ces mots :
¬´ Ceux qui ne travaillent pas en √©t√© auront faim en hiver. ¬ª`
    };




Tortue: `Rien ne sert de courir¬†; il faut partir √† point.
Le Li√®vre et la Tortue en sont un t√©moignage.
Gageons, dit celle-ci, que vous n'atteindrez point
Sit√¥t que moi ce but. ‚Äî¬†Sit√¥t¬†? √ätes-vous sage¬†?
Repartit l'animal l√©ger.
Ma comm√®re, il vous faut purger
Avec quatre grains d'ell√©bore.
‚Äî¬†Sage ou non, je parie encore.
Ainsi fut fait¬†: et de tous deux
On mit pr√®s du but les enjeux¬†:
Savoir quoi, ce n'est pas l'affaire,
Ni de quel juge l'on convint.
Notre Li√®vre n'avait que quatre¬†pas √† faire¬†;
J'entends de ceux qu'il fait lorsque pr√™t d'√™tre atteint
Il s'√©loigne des chiens, les renvoie aux Calendes,
Et leur fait arpenter les landes.
Ayant, dis-je, du temps de reste pour brouter,
Pour dormir, et pour √©couter
D'o√π vient le vent, il laisse la Tortue
Aller son train de S√©nateur.
Elle part, elle s'√©vertue¬†;
Elle se h√¢te avec lenteur.
Lui cependant m√©prise une telle victoire,
Tient la gageure √† peu de gloire,
Croit qu'il y va de son honneur
De partir tard. Il broute, il se repose,
Il s'amuse √† toute autre chose
Qu'√† la gageure. √Ä la fin quand il vit
Que l'autre touchait presque au bout de la carri√®re,
Il partit comme un trait¬†; mais les √©lans qu'il fit
Furent vains¬†: la Tortue arriva la premi√®re.
Eh bien¬†! lui cria-t-elle, avais-je pas raison¬†?
De quoi vous sert votre vitesse¬†?
Moi, l'emporter¬†! et que serait-ce
Si vous portiez une maison¬†?`
    };




Agneau: `La raison du plus fort est toujours la meilleure¬†:
Nous l'allons montrer tout √† l'heure.
Un Agneau se d√©salt√©rait
Dans le courant d'une onde pure.
Un Loup survient √† jeun qui cherchait aventure,
Et que la faim en ces lieux attirait.
Qui te rend si hardi de troubler mon breuvage¬†?
Dit cet animal plein de rage¬†:
Tu seras ch√¢ti√© de ta t√©m√©rit√©.
‚Äî¬†Sire, r√©pond l'Agneau, que votre Majest√©
Ne se mette pas en col√®re¬†;
Mais plut√¥t qu'elle consid√®re
Que je me vas d√©salt√©rant
Dans le courant,
Plus de vingt pas au-dessous d'Elle,
Et que par cons√©quent, en aucune fa√ßon,
Je ne puis troubler sa boisson.
‚Äî¬†Tu la troubles, reprit cette b√™te cruelle,
Et je sais que de moi tu m√©dis l'an pass√©.
‚Äî¬†Comment l'aurais-je fait si je n'√©tais pas n√©¬†?
Reprit l'Agneau, je tette encore ma m√®re.
‚Äî¬†Si ce n'est toi, c'est donc ton fr√®re.
‚Äî¬†Je n'en ai point.
‚Äî¬†C'est donc quelqu'un des tiens¬†:
Car vous ne m'√©pargnez gu√®re,
Vous, vos bergers, et vos chiens.
On me l'a dit¬†: il faut que je me venge.
L√†-dessus, au fond des for√™ts
Le Loup l'emporte, et puis le mange.`
    };



Agneau: `Un jour, sur ses longs pieds, allait je ne sais o√π,
Le H√©ron au long bec emmanch√© d'un long cou.
Il c√¥toyait une rivi√®re.
L'onde √©tait transparente ainsi qu'aux plus beaux jours¬†;
Ma comm√®re la carpe y faisait mille tours
Avec le brochet son comp√®re.
Le H√©ron en e√ªt fait ais√©ment son profit¬†:
Tous approchaient du bord, l'oiseau n'avait qu'√† prendre¬†;
Mais il crut mieux faire d'attendre
Qu'il e√ªt un peu plus d'app√©tit.
Il vivait de r√©gime, et mangeait √† ses heures.
Apr√®s quelques moments l'app√©tit vint¬†: l'oiseau
S'approchant du bord vit sur l'eau
Des Tanches qui sortaient du fond de ces demeures.
Le mets ne lui plut pas¬†; il s'attendait √† mieux
Et montrait un go√ªt d√©daigneux
Comme le rat du bon Horace.
Moi des Tanches¬†? dit-il, moi H√©ron que je fasse
Une si pauvre ch√®re¬†? Et pour qui me prend-on¬†?
La Tanche rebut√©e il trouva du goujon.
Du goujon¬†! c'est bien l√† le d√Æner d'un H√©ron¬†!
J'ouvrirais pour si peu le bec¬†! aux Dieux ne plaise¬†!
Il l'ouvrit pour bien moins¬†: tout alla de fa√ßon
Qu'il ne vit plus aucun poisson.
La faim le prit, il fut tout heureux et tout aise
De rencontrer un lima√ßon.
Ne soyons pas si difficiles¬†:
Les plus accommodants ce sont les plus habiles¬†:
On hasarde de perdre en voulant trop gagner,
Gardez-vous de rien d√©daigner¬†;
Surtout quand vous avez √† peu pr√®s votre compte.
Bien des gens y sont pris¬†; ce n'est pas aux H√©rons
Que je parle¬†; √©coutez, humains, un autre conte¬†;
Vous verrez que chez vous j'ai puis√© ces le√ßons.`
    };



  let rate = 0.5;
  const minRate = 0.25;
  const maxRate = 2.0;
  let paused = false;
  let speaking = false;
  let queue = [];

  function getVoice() {
    const voices = speechSynthesis.getVoices();
    // Privil√©gie une voix masculine bien articul√©e en fran√ßais
    return (
      voices.find(v => v.lang === 'fr-FR' && /thomas|paul|yves|homme/i.test(v.name)) ||
      voices.find(v => v.lang === 'fr-FR')
    );
  }

  function speak(text) {
    speechSynthesis.cancel();
    queue = [];

    // Ajoute les mots des ponctuations
    const parts = text
      .replace(/\n/g, ' ')
      .split(/([.,;:!?])/g)
      .filter(p => p.trim() !== '')
      .map(part => {
        if (part === '.') return 'point';
        if (part === ',') return 'virgule';
        if (part === ';') return 'point-virgule';
        if (part === ':') return 'deux-points';
        if (part === '!') return 'point d\'exclamation';
        if (part === '?') return 'point d\'interrogation';
        return part.trim();
      });

    for (let part of parts) {
      const utterance = new SpeechSynthesisUtterance(part);
      utterance.lang = 'fr-FR';
      utterance.voice = getVoice();
      utterance.rate = rate;

      queue.push(utterance);

      if (['point', 'virgule', 'point-virgule', 'deux-points', 'point d\'exclamation', 'point d\'interrogation'].includes(part)) {
        queue.push('pause');
      }
    }

    speaking = true;
    playQueue();
  }

  async function playQueue() {
    for (let item of queue) {
      while (paused) await new Promise(r => setTimeout(r, 100));
      if (!speaking) return;

      if (item === 'pause') {
        await new Promise(r => setTimeout(r, 5000));
      } else {
        speechSynthesis.speak(item);
        await new Promise(resolve => {
          item.onend = resolve;
        });
      }
    }
    speaking = false;
  }

  function playDictation() {
    const sel = document.getElementById('dictationSelect').value;
    paused = false;
    speaking = true;
    speak(dictations[sel]);
  }

  function togglePause() {
    if (!speaking) return;
    paused = !paused;
    if (paused) {
      speechSynthesis.pause();
    } else {
      speechSynthesis.resume();
    }
  }

  function slowDown() {
    rate = Math.max(minRate, rate - 0.1);
    playDictation();
  }

  function speedUp() {
    rate = Math.min(maxRate, rate + 0.1);
    playDictation();
  }

  function normalize(str) {
    return str
      .toLowerCase()
      .replace(/[.,;:!?¬´¬ª"‚Äù‚Äú‚Äô‚Äò]/g, '')
      .replace(/\s+/g, ' ')
      .trim();
  }

  function checkDictation() {
    const sel = document.getElementById('dictationSelect').value;
    const original = dictations[sel];
    const originalNormalized = normalize(original);
    const user = normalize(document.getElementById('userInput').value);
    const res = document.getElementById('result');

    if (user === originalNormalized) {
      res.innerHTML = `<div style="color:#00e676;">‚úÖ Parfait, ta dict√©e est exacte !</div><pre>${original}</pre>`;
    } else {
      res.innerHTML = `<div style="color:#ff5252;">‚ùå Des erreurs restent √† corriger.</div><pre>${original}</pre>`;
    }
  }

  // Assure que les voix sont bien charg√©es
  window.speechSynthesis.onvoiceschanged = () => {};
</script>