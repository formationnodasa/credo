<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√âpelle-moi Bibliquement !</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #e67e22;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
            --text-color: #333;
            --background-color: #f9f9f9;
        }

        [data-theme="dark"] {
            --primary-color: #34495e;
            --secondary-color: #2980b9;
            --success-color: #229954;
            --warning-color: #d68910;
            --danger-color: #cb4335;
            --light-color: #2c3e50;
            --dark-color: #1a252f;
            --text-color: #ecf0f1;
            --background-color: #1a252f;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--secondary-color);
        }

        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-color);
        }

        .game-container {
            background-color: var(--light-color);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .player-section {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
        }

        .level-selector {
            margin-bottom: 20px;
        }

        select, input, button {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 1rem;
            margin-bottom: 10px;
            background-color: var(--background-color);
            color: var(--text-color);
        }

        button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: var(--primary-color);
        }

        .btn-success {
            background-color: var(--success-color);
        }

        .btn-warning {
            background-color: var(--warning-color);
        }

        .btn-danger {
            background-color: var(--danger-color);
        }

        .word-display {
            text-align: center;
            font-size: 1.5rem;
            margin: 20px 0;
            min-height: 40px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .result-message {
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
            min-height: 24px;
        }

        .success {
            color: var(--success-color);
        }

        .error {
            color: var(--danger-color);
        }

        .progress-container {
            margin-top: 20px;
        }

        .progress-bar {
            height: 20px;
            background-color: #ddd;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--success-color);
            width: 0%;
            transition: width 0.5s;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .progress-section {
            margin-top: 30px;
            background-color: var(--light-color);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .progress-section h2 {
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .history-list {
            list-style-type: none;
            max-height: 200px;
            overflow-y: auto;
        }

        .history-item {
            padding: 8px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .correct {
            color: var(--success-color);
        }

        .incorrect {
            color: var(--danger-color);
        }

        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            
            .game-container, .progress-section {
                padding: 15px;
            }
            
            .word-display {
                font-size: 1.2rem;
            }
            
            .player-section {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" id="themeToggle">üåô</button>
    
    <header>
        <h1>√âpelle-moi Bibliquement !</h1>
        <p>Testez votre connaissance de l'orthographe des noms et termes bibliques</p>
    </header>

    <div class="game-container">
        <div class="player-section">
            <input type="text" id="playerName" placeholder="Votre nom">
            <button id="savePlayerBtn">Enregistrer</button>
        </div>

        <div class="level-selector">
            <select id="levelSelect">
                <option value="random">Niveau Al√©atoire</option>
                <!-- Les options de niveau seront ajout√©es dynamiquement -->
            </select>
        </div>

        <div class="word-display" id="wordDisplay">
            Cliquez sur "Nouveau mot" pour commencer
        </div>

        <div class="result-message" id="resultMessage"></div>

        <button id="listenBtn">√âcouter le mot</button>
        <input type="text" id="spellingInput" placeholder="Entrez l'orthographe du mot">
        <button id="checkBtn">V√©rifier</button>
        <button id="nextBtn" class="btn-warning">Nouveau mot</button>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="stats">
                <span>Score: <span id="scoreDisplay">0</span></span>
                <span>Niveau: <span id="levelDisplay">-</span></span>
            </div>
        </div>
    </div>

    <div class="progress-section">
        <h2>üìä Mes progr√®s</h2>
        <div>
            <p>Score total: <span id="totalScore">0</span></p>
            <p>Meilleur niveau: <span id="bestLevel">-</span></p>
            <p>Pourcentage de r√©ussite: <span id="successRate">0%</span></p>
            <p>R√©ussites: <span id="successCount">0</span></p>
            <p>√âchecs: <span id="failureCount">0</span></p>
        </div>
        
        <h3>Historique r√©cent</h3>
        <ul class="history-list" id="historyList">
            <!-- L'historique sera ajout√© dynamiquement -->
        </ul>
    </div>

    <script>
        // Donn√©es du jeu
        const bibleBooks = [
            "Gen√®se", "Exode", "L√©vitique", "Nombres", "Deut√©ronome", "Josu√©", "Juges",
            "Ruth", "1 Samuel", "2 Samuel", "1 Rois", "2 Rois", "1 Chroniques", "2 Chroniques",
            "Esdras", "N√©h√©mie", "Esther", "Job", "Psaumes", "Proverbes", "Eccl√©siaste", "Cantique des Cantiques",
            "√âsa√Øe", "J√©r√©mie", "Lamentations", "√âz√©chiel", "Daniel", "Os√©e", "Jo√´l", "Amos", "Abdias",
            "Jonas", "Mich√©e", "Nahum", "Habacuc", "Sophonie", "Agg√©e", "Zacharie", "Malachie",
            "Matthieu", "Marc", "Luc", "Jean", "Actes", "Romains", "1 Corinthiens", "2 Corinthiens",
            "Galates", "√âph√©siens", "Philippiens", "Colossiens", "1 Thessaloniciens", "2 Thessaloniciens",
            "1 Timoth√©e", "2 Timoth√©e", "Tite", "Phil√©mon", "H√©breux", "Jacques",
            "1 Pierre", "2 Pierre", "1 Jean", "2 Jean", "3 Jean", "Jude", "Apocalypse"
        ];

        const spellingWords = {
            "Gen√®se": [
                "Dieu", "Yahv√© Dieu", "Adam", "√àve", "serpent", "Ca√Øn", "Abel", "H√©nok", "Irad", "Mehuya√´l",
                "Metusha√´l", "Lamek", "Ada", "Cilla", "Yabal", "Yubal", "Tubal-Ca√Øn", "Naama", "Seth", "Enosh",
                "Q√©n√¢n", "Mahalal√©el", "Y√©red", "H√©nok", "Mathusalem", "Lamek", "No√©", "Sem", "Cham", "Japhet",
                "Nephilim", "ch√©rubins", "Nemrod", "Gomer", "Magog", "Yav√¢n", "Tubal", "Moshek", "Tiras", "Ashkenaz",
                "Riphat", "Togarma", "Elisha", "Kush", "Mi√ßrayim", "Put", "Canaan", "S√©ba", "Havila", "Sabta",
                "Rama", "Sabteka", "Sheba", "Ded√¢n", "Ashshur", "Arpakshad", "Lud", "Aram", "U√ß", "Hul",
                "G√©ter", "Mash", "Sh√©lah", "Eber", "P√©leg", "Yoqt√¢n", "Almodad", "Sh√©leph", "Ha√ß√ßarmavet", "Y√©rah",
                "Hadoram", "Uzal", "Diqla", "Obal", "Abima√´l", "Ophir", "Yobab", "R√©u", "Serug", "Nahor",
                "T√©rah", "Abram", "Har√¢n", "Lot", "Sara√Ø", "Milka", "Yiska", "ciel", "terre", "ab√Æme",
                "vent", "eaux", "lumi√®re", "t√©n√®bres", "jour", "nuit", "firmament", "mers", "verdure", "herbes",
                "arbres", "luminaires", "soleil", "lune", "√©toiles", "serpents", "b√™tes", "bestiaux", "bestioles",
                "arbre de vie", "arbre de la connaissance", "jardin d'Eden", "fleuve d'Eden", "Pish√¥n", "Havila",
                "bdellium", "cornaline", "Gih√¥n", "Kush", "Tigre", "Assur", "Euphrate", "c√¥te", "feuilles", "sueur",
                "pain", "tuniques", "glaive", "sol", "sang", "Nod", "ville", "signe", "arche", "d√©luge", "bitume",
                "corbeau", "colombe", "rameau", "autel", "holocaustes", "arc", "vin", "vigne", "nudit√©", "manteau",
                "esclave", "√Æles", "Babel", "Erek", "Akkad", "Shin√©ar", "Ninive", "Rehobot-Ir", "Kalah", "R√®s√®n",
                "Lud", "Anam", "Lehab", "Naphtuh", "Patros", "Kasluh", "Kaphtor", "Philistins", "Sidon", "J√©bus√©en",
                "Amorite", "Girgashite", "Hivvite", "Arqite", "Sinite", "Arvadite", "Cemarite", "Hamatite", "G√©rar",
                "Gaza", "Sodome", "Gomorrhe", "Adma", "Ceboyim", "L√©sha", "tour", "langue", "Ur", "Chald√©ens", "Sara",
                "Perizzites", "Amraphel", "Aryok", "Kedor-Laomer", "Tid√©al", "B√©ra", "Birsha", "Shin√©ab", "Sh√©me√©ber",
                "B√©la", "Repha√Øm", "Zuzim", "Emim", "Horites", "Amal√©cites", "Mambr√©", "Eshkol", "Aner", "Melchis√©dech",
                "Shalem", "El Elyon", "√âli√©zer", "Q√©nites", "Qenizzites", "Qadmonites", "Hittites", "Agar", "Isma√´l",
                "Ange de Yahv√©", "El-Ro√Ø", "El Shadda√Ø", "Isaac", "h√¥tes", "Moab", "Ben-Ammi", "Abim√©lek", "Pikol"
            ],
            "Exode": ["Pharaon", "Mo√Øse", "plaies", "d√©sert", "loi"],
            "L√©vitique": ["sacrifice", "pr√™tre", "purification", "saint", "offrande"],
            "Nombres": ["recensement", "d√©sert", "manne", "serpent", "proph√©tie"],
            "Deut√©ronome": ["commandements", "alliance", "terre", "b√©n√©diction", "mal√©diction"],
            "Josu√©": ["J√©richo", "Canaan", "conqu√™te", "partage", "tribus"],
            "Juges": ["Samson", "D√©bora", "G√©d√©on", "victoire", "cycle"],
            "Ruth": ["Moab", "glane", "rachat", "Booz", "anc√™tre"],
            "1 Samuel": ["Sa√ºl", "David", "Goliath", "proph√®te", "onction"],
            "2 Samuel": ["J√©rusalem", "alliance", "absalom", "r√©volte", "royaume"],
            "1 Rois": ["Salomon", "temple", "sagesse", "schisme", "proph√®tes"],
            "2 Rois": ["exil", "proph√®tes", "rois", "chute", "Assyrie"],
            "1 Chroniques": ["g√©n√©alogie", "David", "temple", "l√©vites", "chroniques"],
            "2 Chroniques": ["Salomon", "temple", "rois", "r√©forme", "exil"],
            "Esdras": ["retour", "temple", "loi", "r√©forme", "scribe"],
            "N√©h√©mie": ["muraille", "J√©rusalem", "r√©forme", "gouverneur", "peuple"],
            "Esther": ["reine", "Mardoch√©e", "Haman", "pourim", "d√©livrance"],
            "Job": ["souffrance", "amis", "Dieu", "sagesse", "restauration"],
            "Psaumes": ["louange", "pri√®re", "David", "Asaph", "cantique"],
            "Proverbes": ["sagesse", "instruction", "crainte", "folie", "discipline"],
            "Eccl√©siaste": ["vanit√©", "sagesse", "travail", "temps", "mort"],
            "Cantique des Cantiques": ["amour", "fian√ßailles", "Shulamite", "Salomon", "all√©gorie"],
            "√âsa√Øe": ["proph√®te", "messie", "serviteur", "jugement", "salut"],
            "J√©r√©mie": ["proph√®te", "jugement", "nouvelle alliance", "lamentations", "vocation"],
            "Lamentations": ["douleur", "J√©rusalem", "destruction", "pleurs", "esp√©rance"],
            "√âz√©chiel": ["vision", "glorieux", "ossements", "temple", "proph√®te"],
            "Daniel": ["proph√®te", "visions", "lion", "fournaise", "royaumes"],
            "Os√©e": ["proph√®te", "mariage", "infid√©lit√©", "alliance", "restauration"],
            "Jo√´l": ["proph√®te", "jour", "esprit", "jugement", "restauration"],
            "Amos": ["proph√®te", "justice", "jugement", "plomb", "restauration"],
            "Abdias": ["proph√®te", "√âdom", "jugement", "orgueil", "Sion"],
            "Jonas": ["proph√®te", "Ninive", "baleine", "mis√©ricorde", "mission"],
            "Mich√©e": ["proph√®te", "Bethl√©em", "justice", "mis√©ricorde", "messie"],
            "Nahum": ["proph√®te", "Ninive", "jugement", "col√®re", "consolation"],
            "Habacuc": ["proph√®te", "foi", "justice", "vision", "plainte"],
            "Sophonie": ["proph√®te", "jour", "jugement", "restes", "joie"],
            "Agg√©e": ["proph√®te", "temple", "reconstruction", "encouragement", "gloire"],
            "Zacharie": ["proph√®te", "visions", "messie", "J√©rusalem", "restauration"],
            "Malachie": ["proph√®te", "alliance", "d√Æme", "messager", "jour"],
            "Matthieu": ["J√©sus", "royaume", "sermon", "miracles", "disciples"],
            "Marc": ["J√©sus", "√©vangile", "miracles", "serviteur", "croix"],
            "Luc": ["J√©sus", "paraboles", "m√©decin", "salut", "r√©surrection"],
            "Jean": ["J√©sus", "parole", "signes", "amour", "vie"],
            "Actes": ["Esprit", "ap√¥tres", "√©glise", "mission", "Paul"],
            "Romains": ["Paul", "foi", "gr√¢ce", "justification", "√©lection"],
            "1 Corinthiens": ["Paul", "amour", "r√©surrection", "dons", "unit√©"],
            "2 Corinthiens": ["Paul", "minist√®re", "souffrances", "consolation", "gloire"],
            "Galates": ["Paul", "libert√©", "loi", "gr√¢ce", "croix"],
            "√âph√©siens": ["Paul", "√©glise", "b√©n√©dictions", "armure", "unit√©"],
            "Philippiens": ["Paul", "joie", "Christ", "humilit√©", "contentement"],
            "Colossiens": ["Paul", "Christ", "pl√©nitude", "libert√©", "r√®gles"],
            "1 Thessaloniciens": ["Paul", "av√®nement", "saintet√©", "travail", "esp√©rance"],
            "2 Thessaloniciens": ["Paul", "av√®nement", "d√©sordre", "travail", "pers√©v√©rance"],
            "1 Timoth√©e": ["Paul", "Timoth√©e", "doctrine", "conduite", "√©glise"],
            "2 Timoth√©e": ["Paul", "Timoth√©e", "fid√©lit√©", "√âcritures", "combat"],
            "Tite": ["Paul", "Tite", "doctrine", "bonnes ≈ìuvres", "√©glise"],
            "Phil√©mon": ["Paul", "On√©sime", "esclavage", "r√©conciliation", "amour"],
            "H√©breux": ["Christ", "m√©lchis√©dek", "foi", "sacrifice", "alliance"],
            "Jacques": ["foi", "≈ìuvres", "sagesse", "langue", "pri√®re"],
            "1 Pierre": ["Pierre", "souffrance", "esp√©rance", "saintet√©", "pasteurs"],
            "2 Pierre": ["Pierre", "connaissance", "faux docteurs", "av√®nement", "croissance"],
            "1 Jean": ["Jean", "amour", "communion", "antichrist", "assurance"],
            "2 Jean": ["Jean", "v√©rit√©", "amour", "hospitalit√©", "doctrine"],
            "3 Jean": ["Jean", "Ga√Øus", "Diotr√®phe", "hospitalit√©", "v√©rit√©"],
            "Jude": ["Jude", "contention", "apostasie", "mis√©ricorde", "gloire"],
            "Apocalypse": ["Jean", "visions", "jugements", "nouvelle cr√©ation", "victoire"]
        };

        // √âtat du jeu
        let gameState = {
            currentPlayer: "",
            currentLevel: "random",
            currentWord: "",
            currentWordBook: "",
            score: 0,
            totalAttempts: 0,
            correctAttempts: 0,
            history: [],
            progressData: {}
        };

        // √âl√©ments DOM
        const playerNameInput = document.getElementById('playerName');
        const savePlayerBtn = document.getElementById('savePlayerBtn');
        const levelSelect = document.getElementById('levelSelect');
        const wordDisplay = document.getElementById('wordDisplay');
        const spellingInput = document.getElementById('spellingInput');
        const checkBtn = document.getElementById('checkBtn');
        const nextBtn = document.getElementById('nextBtn');
        const listenBtn = document.getElementById('listenBtn');
        const resultMessage = document.getElementById('resultMessage');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const levelDisplay = document.getElementById('levelDisplay');
        const progressFill = document.getElementById('progressFill');
        const totalScore = document.getElementById('totalScore');
        const bestLevel = document.getElementById('bestLevel');
        const successRate = document.getElementById('successRate');
        const successCount = document.getElementById('successCount');
        const failureCount = document.getElementById('failureCount');
        const historyList = document.getElementById('historyList');
        const themeToggle = document.getElementById('themeToggle');

        // Initialisation
        function init() {
            // Charger les donn√©es sauvegard√©es
            loadProgressData();
            
            // Remplir le s√©lecteur de niveaux
            bibleBooks.forEach(book => {
                const option = document.createElement('option');
                option.value = book;
                option.textContent = book;
                levelSelect.appendChild(option);
            });
            
            // D√©finir le niveau actuel
            levelSelect.value = gameState.currentLevel;
            updateLevelDisplay();
            
            // Mettre √† jour l'affichage du score
            updateScoreDisplay();
            
            // Mettre √† jour les statistiques
            updateStats();
            
            // √âv√©nements
            savePlayerBtn.addEventListener('click', savePlayerName);
            levelSelect.addEventListener('change', onLevelChange);
            checkBtn.addEventListener('click', checkSpelling);
            nextBtn.addEventListener('click', getNewWord);
            listenBtn.addEventListener('click', speakCurrentWord);
            spellingInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkSpelling();
                }
            });
            themeToggle.addEventListener('click', toggleTheme);
            
            // Appliquer le th√®me sauvegard√©
            const savedTheme = localStorage.getItem('spellingGameTheme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            themeToggle.textContent = savedTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
            
            // Premier mot
            getNewWord();
        }

        // Enregistrer le nom du joueur
        function savePlayerName() {
            const playerName = playerNameInput.value.trim();
            if (playerName) {
                gameState.currentPlayer = playerName;
                localStorage.setItem('spellingGamePlayer', playerName);
                alert(`Joueur ${playerName} enregistr√© avec succ√®s !`);
                
                // Charger les donn√©es de ce joueur
                loadProgressData();
                updateStats();
            } else {
                alert("Veuillez entrer un nom valide");
            }
        }

        // Charger les donn√©es de progression
        function loadProgressData() {
            // Charger le nom du joueur
            const savedPlayer = localStorage.getItem('spellingGamePlayer');
            if (savedPlayer) {
                gameState.currentPlayer = savedPlayer;
                playerNameInput.value = savedPlayer;
            }
            
            // Charger les donn√©es de progression
            const savedData = localStorage.getItem('spellingGameProgress');
            if (savedData) {
                const allProgressData = JSON.parse(savedData);
                
                // Si un joueur est d√©fini, charger ses donn√©es
                if (gameState.currentPlayer && allProgressData[gameState.currentPlayer]) {
                    gameState.progressData = allProgressData[gameState.currentPlayer];
                    
                    // R√©cup√©rer les donn√©es pour le niveau actuel
                    if (gameState.progressData[gameState.currentLevel]) {
                        const levelData = gameState.progressData[gameState.currentLevel];
                        gameState.score = levelData.score || 0;
                        gameState.totalAttempts = levelData.totalAttempts || 0;
                        gameState.correctAttempts = levelData.correctAttempts || 0;
                        gameState.history = levelData.history || [];
                    }
                } else {
                    // Initialiser les donn√©es pour ce joueur
                    gameState.progressData = {};
                }
            } else {
                // Initialiser les donn√©es globales
                gameState.progressData = {};
            }
        }

        // Sauvegarder les donn√©es de progression
        function saveProgressData() {
            // V√©rifier qu'un joueur est d√©fini
            if (!gameState.currentPlayer) {
                alert("Veuillez d'abord enregistrer votre nom");
                return;
            }
            
            // Charger toutes les donn√©es existantes
            let allProgressData = {};
            const savedData = localStorage.getItem('spellingGameProgress');
            if (savedData) {
                allProgressData = JSON.parse(savedData);
            }
            
            // Mettre √† jour les donn√©es pour le joueur actuel
            if (!allProgressData[gameState.currentPlayer]) {
                allProgressData[gameState.currentPlayer] = {};
            }
            
            // Mettre √† jour les donn√©es pour le niveau actuel
            if (!allProgressData[gameState.currentPlayer][gameState.currentLevel]) {
                allProgressData[gameState.currentPlayer][gameState.currentLevel] = {};
            }
            
            allProgressData[gameState.currentPlayer][gameState.currentLevel].score = gameState.score;
            allProgressData[gameState.currentPlayer][gameState.currentLevel].totalAttempts = gameState.totalAttempts;
            allProgressData[gameState.currentPlayer][gameState.currentLevel].correctAttempts = gameState.correctAttempts;
            allProgressData[gameState.currentPlayer][gameState.currentLevel].history = gameState.history;
            
            // Sauvegarder dans le localStorage
            localStorage.setItem('spellingGameProgress', JSON.stringify(allProgressData));
        }

        // Changer de niveau
        function onLevelChange() {
            gameState.currentLevel = levelSelect.value;
            
            // Charger les donn√©es pour ce niveau
            if (gameState.progressData[gameState.currentLevel]) {
                const levelData = gameState.progressData[gameState.currentLevel];
                gameState.score = levelData.score || 0;
                gameState.totalAttempts = levelData.totalAttempts || 0;
                gameState.correctAttempts = levelData.correctAttempts || 0;
                gameState.history = levelData.history || [];
            } else {
                // R√©initialiser pour un nouveau niveau
                gameState.score = 0;
                gameState.totalAttempts = 0;
                gameState.correctAttempts = 0;
                gameState.history = [];
            }
            
            updateLevelDisplay();
            updateScoreDisplay();
            updateStats();
            getNewWord();
        }

        // Obtenir un nouveau mot
        function getNewWord() {
            // V√©rifier qu'un joueur est d√©fini
            if (!gameState.currentPlayer) {
                alert("Veuillez d'abord enregistrer votre nom");
                return;
            }
            
            // R√©initialiser l'affichage
            spellingInput.value = "";
            resultMessage.textContent = "";
            resultMessage.className = "result-message";
            
            // Choisir un livre
            let book;
            if (gameState.currentLevel === "random") {
                // S√©lectionner un livre au hasard
                const randomIndex = Math.floor(Math.random() * bibleBooks.length);
                book = bibleBooks[randomIndex];
            } else {
                book = gameState.currentLevel;
            }
            
            // Choisir un mot dans ce livre
            const words = spellingWords[book];
            if (words && words.length > 0) {
                const randomIndex = Math.floor(Math.random() * words.length);
                gameState.currentWord = words[randomIndex];
                gameState.currentWordBook = book;
                
                // Afficher le mot (masqu√© pour l'√©pellation)
                wordDisplay.textContent = "?";
            } else {
                wordDisplay.textContent = "Aucun mot disponible pour ce niveau";
            }
            
            // Focus sur le champ de saisie
            spellingInput.focus();
        }

        // V√©rifier l'orthographe
        function checkSpelling() {
            // V√©rifier qu'un joueur est d√©fini
            if (!gameState.currentPlayer) {
                alert("Veuillez d'abord enregistrer votre nom");
                return;
            }
            
            const userInput = spellingInput.value.trim();
            
            if (!userInput) {
                resultMessage.textContent = "Veuillez entrer une r√©ponse";
                resultMessage.className = "result-message error";
                return;
            }
            
            // V√©rifier la r√©ponse (insensible √† la casse et aux accents)
            const normalizedInput = userInput.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
            const normalizedWord = gameState.currentWord.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
            
            const isCorrect = normalizedInput === normalizedWord;
            
            // Mettre √† jour les statistiques
            gameState.totalAttempts++;
            if (isCorrect) {
                gameState.correctAttempts++;
                gameState.score += 10;
                resultMessage.textContent = "Correct !";
                resultMessage.className = "result-message success";
            } else {
                resultMessage.textContent = `Incorrect. La bonne r√©ponse √©tait : ${gameState.currentWord}`;
                resultMessage.className = "result-message error";
            }
            
            // Ajouter √† l'historique
            gameState.history.unshift({
                word: gameState.currentWord,
                userInput: userInput,
                isCorrect: isCorrect,
                book: gameState.currentWordBook,
                timestamp: new Date().toLocaleString()
            });
            
            // Limiter l'historique aux 10 derni√®res entr√©es
            if (gameState.history.length > 10) {
                gameState.history = gameState.history.slice(0, 10);
            }
            
            // Afficher le mot correct
            wordDisplay.textContent = gameState.currentWord;
            
            // Mettre √† jour l'affichage
            updateScoreDisplay();
            updateStats();
            
            // Sauvegarder les progr√®s
            saveProgressData();
        }

        // Lire le mot actuel
        function speakCurrentWord() {
            if (!gameState.currentWord) return;
            
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(gameState.currentWord);
                utterance.lang = 'fr-FR';
                utterance.rate = 0.9;
                utterance.pitch = 1;
                
                // Essayer de trouver une voix fran√ßaise
                const voices = speechSynthesis.getVoices();
                const frenchVoice = voices.find(voice => 
                    voice.lang.includes('fr') && voice.name.includes('Female')
                );
                
                if (frenchVoice) {
                    utterance.voice = frenchVoice;
                }
                
                speechSynthesis.speak(utterance);
            } else {
                alert("La synth√®se vocale n'est pas support√©e par votre navigateur");
            }
        }

        // Mettre √† jour l'affichage du score
        function updateScoreDisplay() {
            scoreDisplay.textContent = gameState.score;
            
            // Mettre √† jour la barre de progression
            const progressPercentage = Math.min(gameState.score / 100 * 100, 100);
            progressFill.style.width = `${progressPercentage}%`;
        }

        // Mettre √† jour l'affichage du niveau
        function updateLevelDisplay() {
            levelDisplay.textContent = gameState.currentLevel === "random" ? "Al√©atoire" : gameState.currentLevel;
        }

        // Mettre √† jour les statistiques
        function updateStats() {
            // Score total pour ce joueur
            let totalScoreValue = 0;
            let totalAttempts = 0;
            let totalCorrect = 0;
            
            if (gameState.progressData) {
                Object.values(gameState.progressData).forEach(levelData => {
                    totalScoreValue += levelData.score || 0;
                    totalAttempts += levelData.totalAttempts || 0;
                    totalCorrect += levelData.correctAttempts || 0;
                });
            }
            
            totalScore.textContent = totalScoreValue;
            
            // Meilleur niveau pour ce joueur
            let bestLevelValue = "-";
            let highestScore = 0;
            
            if (gameState.progressData) {
                Object.entries(gameState.progressData).forEach(([level, data]) => {
                    if (data.score > highestScore) {
                        highestScore = data.score;
                        bestLevelValue = level === "random" ? "Al√©atoire" : level;
                    }
                });
            }
            
            bestLevel.textContent = bestLevelValue;
            
            // Taux de r√©ussite global
            const successRateValue = totalAttempts > 0 
                ? Math.round((totalCorrect / totalAttempts) * 100) 
                : 0;
            successRate.textContent = `${successRateValue}%`;
            
            // Compteurs de r√©ussites et √©checs pour le niveau actuel
            successCount.textContent = gameState.correctAttempts;
            failureCount.textContent = gameState.totalAttempts - gameState.correctAttempts;
            
            // Historique
            historyList.innerHTML = "";
            gameState.history.forEach(item => {
                const li = document.createElement('li');
                li.className = `history-item ${item.isCorrect ? 'correct' : 'incorrect'}`;
                li.innerHTML = `
                    <span>${item.word}</span>
                    <span>${item.isCorrect ? '‚úì' : '‚úó'}</span>
                `;
                historyList.appendChild(li);
            });
        }

        // Basculer entre les th√®mes clair et sombre
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            themeToggle.textContent = newTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
            
            localStorage.setItem('spellingGameTheme', newTheme);
        }

        // Initialiser le jeu au chargement de la page
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>