<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duel d'Épellation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        /* Écran de connexion */
        .login-screen {
            padding: 40px;
            text-align: center;
        }

        .login-screen h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .players-setup {
            display: flex;
            justify-content: space-around;
            gap: 30px;
            margin-bottom: 30px;
        }

        .player-input {
            flex: 1;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .player-input h3 {
            margin-bottom: 15px;
            color: #555;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            text-align: center;
        }

        .start-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .start-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .start-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        /* Écran de jeu */
        .game-screen {
            display: none;
            padding: 20px;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 0 20px;
        }

        .players-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-bottom: 30px;
        }

        .player-card {
            flex: 1;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .player-card.active {
            border-color: #4CAF50;
            background: #e8f5e8;
        }

        .player-card.correct {
            border-color: #4CAF50;
            background: #e8f5e8;
        }

        .player-card.incorrect {
            border-color: #f44336;
            background: #ffeaea;
        }

        .player-name {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .player-score {
            font-size: 2em;
            color: #667eea;
            font-weight: bold;
        }

        .word-display {
            text-align: center;
            margin: 30px 0;
            padding: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
            color: white;
        }

        .current-word {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .listen-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid white;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .listen-btn:hover {
            background: white;
            color: #667eea;
        }

        .answers-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-bottom: 20px;
        }

        .answer-input {
            flex: 1;
        }

        .answer-input input {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            border: 2px solid #ddd;
            border-radius: 8px;
            text-align: center;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            background: #45a049;
        }

        .submit-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }

        .timer {
            text-align: center;
            font-size: 1.2em;
            color: #666;
            margin: 20px 0;
        }

        .round-info {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
        }

        /* Écran de fin */
        .end-screen {
            display: none;
            padding: 40px;
            text-align: center;
        }

        .winner-message {
            font-size: 2.5em;
            color: #4CAF50;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .final-scores {
            display: flex;
            justify-content: center;
            gap: 50px;
            margin: 30px 0;
        }

        .final-score {
            font-size: 1.5em;
            color: #333;
        }

        .replay-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .replay-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .status-message {
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
            min-height: 24px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Écran de connexion -->
        <div class="login-screen" id="loginScreen">
            <h1>🚀 Duel d'Épellation 🚀</h1>
            <div class="players-setup">
                <div class="player-input">
                    <h3>Joueur 1</h3>
                    <input type="text" id="player1Name" placeholder="Entrez votre pseudo" maxlength="15">
                </div>
                <div class="player-input">
                    <h3>Joueur 2</h3>
                    <input type="text" id="player2Name" placeholder="Entrez votre pseudo" maxlength="15">
                </div>
            </div>
            <button class="start-btn" id="startBtn" disabled>Commencer le Duel</button>
        </div>

        <!-- Écran de jeu -->
        <div class="game-screen" id="gameScreen">
            <div class="game-header">
                <div class="round-info" id="roundInfo">Manche 1/5</div>
                <div class="timer" id="timer">Temps restant: 30s</div>
            </div>
            
            <div class="players-container">
                <div class="player-card" id="player1Card">
                    <div class="player-name" id="player1Display">Joueur 1</div>
                    <div class="player-score" id="player1Score">0</div>
                </div>
                <div class="player-card" id="player2Card">
                    <div class="player-name" id="player2Display">Joueur 2</div>
                    <div class="player-score" id="player2Score">0</div>
                </div>
            </div>

            <div class="word-display">
                <div class="current-word" id="currentWord">Prêt ?</div>
                <button class="listen-btn" id="listenBtn">🔊 Écouter le mot</button>
            </div>

            <div class="status-message" id="statusMessage"></div>

            <div class="answers-container">
                <div class="answer-input">
                    <input type="text" id="player1Answer" placeholder="Épelez le mot..." disabled>
                    <button class="submit-btn" id="player1Submit" disabled>Valider</button>
                </div>
                <div class="answer-input">
                    <input type="text" id="player2Answer" placeholder="Épelez le mot..." disabled>
                    <button class="submit-btn" id="player2Submit" disabled>Valider</button>
                </div>
            </div>
        </div>

        <!-- Écran de fin -->
        <div class="end-screen" id="endScreen">
            <h1>🎯 Partie Terminée !</h1>
            <div class="winner-message" id="winnerMessage"></div>
            <div class="final-scores">
                <div class="final-score">
                    <span id="finalPlayer1Name">Joueur 1</span>: <span id="finalPlayer1Score">0</span> points
                </div>
                <div class="final-score">
                    <span id="finalPlayer2Name">Joueur 2</span>: <span id="finalPlayer2Score">0</span> points
                </div>
            </div>
            <button class="replay-btn" id="replayBtn">Rejouer</button>
        </div>
    </div>

    <script>
        // Liste des mots à épeler
        const words = [
            "Abraham", "Moïse", "Jérusalem", "Nazareth", "Évangile", "Psaume",
            "Bethléem", "Galilée", "Jésus", "David", "Salomon", "Prophète",
            "Apôtre", "Miracle", "Parabole", "Résurrection", "Ascension"
        ];

        // Éléments DOM
        const loginScreen = document.getElementById('loginScreen');
        const gameScreen = document.getElementById('gameScreen');
        const endScreen = document.getElementById('endScreen');

        const player1NameInput = document.getElementById('player1Name');
        const player2NameInput = document.getElementById('player2Name');
        const startBtn = document.getElementById('startBtn');

        const player1Display = document.getElementById('player1Display');
        const player2Display = document.getElementById('player2Display');
        const player1Score = document.getElementById('player1Score');
        const player2Score = document.getElementById('player2Score');
        const player1Card = document.getElementById('player1Card');
        const player2Card = document.getElementById('player2Card');

        const currentWord = document.getElementById('currentWord');
        const listenBtn = document.getElementById('listenBtn');
        const roundInfo = document.getElementById('roundInfo');
        const timerDisplay = document.getElementById('timer');
        const statusMessage = document.getElementById('statusMessage');

        const player1Answer = document.getElementById('player1Answer');
        const player2Answer = document.getElementById('player2Answer');
        const player1Submit = document.getElementById('player1Submit');
        const player2Submit = document.getElementById('player2Submit');

        const winnerMessage = document.getElementById('winnerMessage');
        const finalPlayer1Name = document.getElementById('finalPlayer1Name');
        const finalPlayer2Name = document.getElementById('finalPlayer2Name');
        const finalPlayer1Score = document.getElementById('finalPlayer1Score');
        const finalPlayer2Score = document.getElementById('finalPlayer2Score');
        const replayBtn = document.getElementById('replayBtn');

        // Variables du jeu
        let player1 = { name: '', score: 0, answered: false };
        let player2 = { name: '', score: 0, answered: false };
        let currentRound = 0;
        let totalRounds = 5;
        let currentWordObj = null;
        let timeLeft = 30;
        let timerInterval = null;
        let speechSynth = window.speechSynthesis;

        // Vérification des noms des joueurs
        player1NameInput.addEventListener('input', checkNames);
        player2NameInput.addEventListener('input', checkNames);

        function checkNames() {
            const p1 = player1NameInput.value.trim();
            const p2 = player2NameInput.value.trim();
            startBtn.disabled = !(p1 && p2 && p1 !== p2);
        }

        // Démarrer le jeu
        startBtn.addEventListener('click', startGame);

        function startGame() {
            player1.name = player1NameInput.value.trim();
            player2.name = player2NameInput.value.trim();
            
            if (!player1.name || !player2.name || player1.name === player2.name) {
                alert('Veuillez entrer deux noms différents pour les joueurs');
                return;
            }

            player1Display.textContent = player1.name;
            player2Display.textContent = player2.name;
            player1Score.textContent = '0';
            player2Score.textContent = '0';

            loginScreen.style.display = 'none';
            gameScreen.style.display = 'block';

            currentRound = 0;
            player1.score = 0;
            player2.score = 0;
            player1.answered = false;
            player2.answered = false;

            nextRound();
        }

        function nextRound() {
            currentRound++;
            
            if (currentRound > totalRounds) {
                endGame();
                return;
            }

            // Réinitialiser pour le nouveau round
            player1.answered = false;
            player2.answered = false;
            player1Answer.value = '';
            player2Answer.value = '';
            player1Answer.disabled = false;
            player2Answer.disabled = false;
            player1Submit.disabled = false;
            player2Submit.disabled = false;
            player1Card.classList.remove('correct', 'incorrect', 'active');
            player2Card.classList.remove('correct', 'incorrect', 'active');
            statusMessage.textContent = '';

            // Choisir un mot aléatoire
            currentWordObj = words[Math.floor(Math.random() * words.length)];
            currentWord.textContent = '?'.repeat(currentWordObj.length);
            
            roundInfo.textContent = `Manche ${currentRound}/${totalRounds}`;
            timeLeft = 30;
            timerDisplay.textContent = `Temps restant: ${timeLeft}s`;

            // Lancer le timer
            clearInterval(timerInterval);
            timerInterval = setInterval(updateTimer, 1000);

            // Prononcer le mot après un délai
            setTimeout(speakWord, 1000);

            // Activer les champs de réponse après la prononciation
            setTimeout(() => {
                currentWord.textContent = currentWordObj;
                player1Answer.disabled = false;
                player2Answer.disabled = false;
                player1Submit.disabled = false;
                player2Submit.disabled = false;
                player1Answer.focus();
            }, 2000);
        }

        function speakWord() {
            if (speechSynth.speaking) {
                speechSynth.cancel();
            }

            const utterance = new SpeechSynthesisUtterance(currentWordObj);
            utterance.lang = 'fr-FR';
            utterance.rate = 0.8;
            utterance.pitch = 1.0;
            
            // Essayer d'obtenir une voix masculine
            const voices = speechSynth.getVoices();
            const maleVoice = voices.find(voice => 
                voice.lang.includes('fr') && voice.name.toLowerCase().includes('male')
            ) || voices.find(voice => voice.lang.includes('fr'));
            
            if (maleVoice) {
                utterance.voice = maleVoice;
            }
            
            speechSynth.speak(utterance);
        }

        function updateTimer() {
            timeLeft--;
            timerDisplay.textContent = `Temps restant: ${timeLeft}s`;

            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                checkRoundEnd();
            }
        }

        // Écouteurs pour les boutons de validation
        player1Submit.addEventListener('click', () => submitAnswer(1));
        player2Submit.addEventListener('click', () => submitAnswer(2));

        player1Answer.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') submitAnswer(1);
        });

        player2Answer.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') submitAnswer(2);
        });

        // Bouton pour réécouter le mot
        listenBtn.addEventListener('click', speakWord);

        function submitAnswer(playerNumber) {
            const answerField = playerNumber === 1 ? player1Answer : player2Answer;
            const player = playerNumber === 1 ? player1 : player2;
            const playerCard = playerNumber === 1 ? player1Card : player2Card;

            const answer = answerField.value.trim();

            if (!answer) {
                statusMessage.textContent = `${player.name}, veuillez entrer une réponse!`;
                statusMessage.style.color = '#f44336';
                return;
            }

            player.answered = true;
            answerField.disabled = true;
            playerNumber === 1 ? player1Submit.disabled = true : player2Submit.disabled = true;

            // Vérifier la réponse
            const isCorrect = answer.toLowerCase() === currentWordObj.toLowerCase();
            
            if (isCorrect) {
                player.score++;
                playerCard.classList.add('correct');
                statusMessage.textContent = `✅ ${player.name} a correctement épelé le mot!`;
                statusMessage.style.color = '#4CAF50';
                
                // Mettre à jour le score
                if (playerNumber === 1) {
                    player1Score.textContent = player1.score;
                } else {
                    player2Score.textContent = player2.score;
                }
            } else {
                playerCard.classList.add('incorrect');
                statusMessage.textContent = `❌ ${player.name} s'est trompé! Le mot était: ${currentWordObj}`;
                statusMessage.style.color = '#f44336';
            }

            checkRoundEnd();
        }

        function checkRoundEnd() {
            if ((player1.answered && player2.answered) || timeLeft <= 0) {
                clearInterval(timerInterval);
                
                // Si un joueur n'a pas répondu à la fin du temps
                if (!player1.answered && timeLeft <= 0) {
                    player1Card.classList.add('incorrect');
                    statusMessage.textContent += ` ${player1.name} n'a pas répondu à temps!`;
                }
                if (!player2.answered && timeLeft <= 0) {
                    player2Card.classList.add('incorrect');
                    statusMessage.textContent += ` ${player2.name} n'a pas répondu à temps!`;
                }

                // Passer au round suivant après 3 secondes
                setTimeout(nextRound, 3000);
            }
        }

        function endGame() {
            gameScreen.style.display = 'none';
            endScreen.style.display = 'block';

            finalPlayer1Name.textContent = player1.name;
            finalPlayer2Name.textContent = player2.name;
            finalPlayer1Score.textContent = player1.score;
            finalPlayer2Score.textContent = player2.score;

            if (player1.score > player2.score) {
                winnerMessage.textContent = `🎉 ${player1.name} gagne la partie !`;
            } else if (player2.score > player1.score) {
                winnerMessage.textContent = `🎉 ${player2.name} gagne la partie !`;
            } else {
                winnerMessage.textContent = '🤝 Match nul !';
            }
        }

        // Bouton rejouer
        replayBtn.addEventListener('click', () => {
            endScreen.style.display = 'none';
            loginScreen.style.display = 'block';
            
            // Réinitialiser les noms
            player1NameInput.value = player1.name;
            player2NameInput.value = player2.name;
            checkNames();
        });

        // Initialisation
        checkNames();
    </script>
</body>
</html>