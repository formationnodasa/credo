// gameLogic.js
import { db, serverTimestamp, generateGameCode } from './firebase';
import { doc, setDoc } from "firebase/firestore";
import { CATEGORIES } from './questions'; // Your question data

export async function createGame(hostId, playerName, totalQuestions) {
  const gameCode = generateGameCode();
  const gameRef = doc(db, "games", gameCode);

  await setDoc(gameRef, {
    hostId,
    status: "waiting",
    settings: {
      totalQuestions,
      currentCategoryIndex: 0
    },
    currentQuestion: null,
    players: {
      [hostId]: { name: playerName, score: 0, hasAnswered: false }
    },
    categories: CATEGORIES.map(cat => ({
      ...cat,
      isCompleted: false
    })),
    createdAt: serverTimestamp()
  });

  return gameCode;
}