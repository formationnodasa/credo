<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syst√®me de Vote √âlectronique - √âlections 2024</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .voting-section {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
        }
        
        .code-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
        }
        
        .results-section {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .section-title {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--secondary-color);
            font-size: 1.8rem;
        }
        
        .code-input {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .code-input input {
            flex: 1;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .code-input input:focus {
            outline: none;
            border-color: var(--secondary-color);
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn-primary {
            background: var(--secondary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        .btn-success {
            background: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background: #229954;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
        }
        
        .btn-danger {
            background: var(--danger-color);
            color: white;
        }
        
        .candidates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .candidate-card {
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .candidate-card:hover {
            transform: translateY(-5px);
            border-color: var(--secondary-color);
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.2);
        }
        
        .candidate-card.selected {
            border-color: var(--success-color);
            background: linear-gradient(135deg, #d4efdf 0%, #e8f8f5 100%);
        }
        
        .candidate-number {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--primary-color);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .candidate-name {
            font-size: 1.4rem;
            color: var(--primary-color);
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .candidate-party {
            color: var(--secondary-color);
            font-weight: 500;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .candidate-description {
            color: #666;
            line-height: 1.6;
        }
        
        .vote-confirm {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            display: none;
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }
        
        .alert-success {
            background: #d4efdf;
            color: #27ae60;
            border: 1px solid #a3e4c1;
        }
        
        .alert-danger {
            background: #fadbd8;
            color: #e74c3c;
            border: 1px solid #f5b7b1;
        }
        
        .alert-warning {
            background: #fdebd0;
            color: #f39c12;
            border: 1px solid #f8c471;
        }
        
        .results-chart {
            height: 400px;
            margin-top: 30px;
        }
        
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .results-table th,
        .results-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .results-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .results-table tr:hover {
            background: #f5f5f5;
        }
        
        .vote-progress {
            background: #e9ecef;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .vote-progress-bar {
            height: 100%;
            background: var(--success-color);
            border-radius: 5px;
            transition: width 1s ease-in-out;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--secondary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .vote-code-display {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 10px 0;
            font-family: monospace;
            font-size: 1.2rem;
            letter-spacing: 2px;
        }
        
        .footer {
            text-align: center;
            color: white;
            margin-top: 30px;
            padding: 20px;
            opacity: 0.8;
        }
        
        @media (max-width: 768px) {
            .candidates-grid {
                grid-template-columns: 1fr;
            }
            
            .code-input {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üó≥Ô∏è Syst√®me de Vote √âlectronique</h1>
            <p>Votez en toute s√©curit√© pour les √©lections 2024</p>
            <p><small>Un vote par code - Syst√®me anonyme et s√©curis√©</small></p>
        </div>
        
        <div id="codeSection" class="code-section">
            <h2 class="section-title">√âtape 1 : Authentification</h2>
            <div id="alertCode" class="alert alert-danger">Code invalide ou d√©j√† utilis√©</div>
            <div id="alertSuccess" class="alert alert-success">Code valid√© avec succ√®s ! Redirection...</div>
            
            <div class="code-input">
                <input type="text" id="voteCode" placeholder="Entrez votre code de vote (ex: K7P4J9M2N6)" maxlength="10">
                <button id="validateCode" class="btn btn-primary">Valider le code</button>
            </div>
            
            <div class="vote-code-display">
                <strong>Exemple de code valide :</strong> K7P4J9M2N6
            </div>
            
            <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                <h3 style="color: var(--primary-color); margin-bottom: 10px;">üìã Instructions :</h3>
                <ol style="margin-left: 20px; color: #555;">
                    <li>Entrez votre code de vote √† usage unique</li>
                    <li>Cliquez sur "Valider le code"</li>
                    <li>S√©lectionnez votre candidat pr√©f√©r√©</li>
                    <li>Confirmez votre vote</li>
                    <li>Recevez une confirmation de vote</li>
                </ol>
            </div>
        </div>
        
        <div id="votingSection" class="voting-section">
            <h2 class="section-title">√âtape 2 : S√©lection du Candidat</h2>
            <p style="margin-bottom: 20px; color: #666;">Cliquez sur un candidat pour le s√©lectionner, puis confirmez votre vote.</p>
            
            <div id="alertVote" class="alert alert-warning">Veuillez s√©lectionner un candidat</div>
            
            <div class="candidates-grid" id="candidatesContainer">
                <!-- Les candidats seront g√©n√©r√©s ici par JavaScript -->
            </div>
            
            <div id="voteConfirm" class="vote-confirm">
                <h3 style="color: var(--primary-color); margin-bottom: 15px;">Confirmez votre vote</h3>
                <p style="margin-bottom: 20px;">Vous avez s√©lectionn√© : <strong id="selectedCandidateName"></strong></p>
                <div>
                    <button id="confirmVote" class="btn btn-success" style="margin-right: 10px;">‚úÖ Confirmer le vote</button>
                    <button id="cancelVote" class="btn btn-danger">‚ùå Annuler</button>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button id="submitVote" class="btn btn-primary" style="padding: 15px 50px;">Soumettre mon vote</button>
            </div>
        </div>
        
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Traitement de votre vote en cours...</p>
            <p><small>Veuillez patienter, cette op√©ration est s√©curis√©e.</small></p>
        </div>
        
        <div id="resultsSection" class="results-section">
            <h2 class="section-title">R√©sultats du Vote</h2>
            <p style="margin-bottom: 20px; color: #666;">Les r√©sultats sont mis √† jour en temps r√©el.</p>
            
            <div class="results-chart" id="resultsChart">
                <!-- Le graphique sera g√©n√©r√© ici -->
            </div>
            
            <table class="results-table" id="resultsTable">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Candidat</th>
                        <th>Parti</th>
                        <th>Votes</th>
                        <th>Pourcentage</th>
                        <th>Progression</th>
                    </tr>
                </thead>
                <tbody id="resultsBody">
                    <!-- Les r√©sultats seront ajout√©s ici -->
                </tbody>
            </table>
            
            <div style="text-align: center; margin-top: 30px;">
                <button id="backToVote" class="btn btn-primary">Retour au vote</button>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>Syst√®me de vote s√©curis√© &copy; 2024 - Tous droits r√©serv√©s</p>
        <p><small>Ce syst√®me utilise un chiffrement avanc√© pour prot√©ger votre anonymat.</small></p>
    </div>

    <script>
        // Donn√©es des candidats
        const candidates = [
            {
                id: 1,
                name: "Marie Dubois",
                party: "Parti Progressiste",
                description: "Ancienne ministre de l'√âducation, engag√©e pour l'innovation et la justice sociale."
            },
            {
                id: 2,
                name: "Jean Martin",
                party: "Alliance D√©mocratique",
                description: "√âconomiste renomm√©, sp√©cialiste des finances publiques et de la croissance durable."
            },
            {
                id: 3,
                name: "Sophie Bernard",
                party: "Mouvement √âcologique",
                description: "Militante environnementale, d√©fenseuse du d√©veloppement durable et de la biodiversit√©."
            },
            {
                id: 4,
                name: "Thomas Leroy",
                party: "Union R√©publicaine",
                description: "Ancien maire, expert en s√©curit√© et d√©fense des valeurs traditionnelles."
            },
            {
                id: 5,
                name: "Camille Petit",
                party: "Parti Social",
                description: "Syndicaliste, engag√©e pour les droits des travailleurs et la protection sociale."
            },
            {
                id: 6,
                name: "Alexandre Moreau",
                party: "Centre Lib√©ral",
                description: "Entrepreneur, partisan de l'√©conomie de march√© et des libert√©s individuelles."
            },
            {
                id: 7,
                name: "Julie Fontaine",
                party: "Parti des R√©gions",
                description: "Maire rurale, d√©fenseuse des territoires et de la d√©centralisation."
            },
            {
                id: 8,
                name: "Mohamed Ali",
                party: "Diversit√© et Progr√®s",
                description: "Journaliste, promoteur de la diversit√© culturelle et de l'int√©gration."
            },
            {
                id: 9,
                name: "Isabelle Lambert",
                party: "Parti de la Famille",
                description: "Assistante sociale, engag√©e pour la famille et les services publics."
            },
            {
                id: 10,
                name: "Pierre Garnier",
                party: "Nouvelle Vision",
                description: "Chercheur en intelligence artificielle, partisan de la transformation num√©rique."
            }
        ];

        // Codes de vote valides (en r√©alit√©, il faudrait une base de donn√©es)
        const validCodes = [
            "K7P4J9M2N6", "Q1R8S3T5V9", "W2X4Y6Z7B8", "C3D5F7G9H2", "J4K6L8M1N3",
            "P5Q7R9S2T4", "V6W8X1Y3Z5", "B7C9D2F4G6", "H8J1K3L5M7", "N9P2Q4R6S8"
        ];

        // Codes d√©j√† utilis√©s (simulation)
        let usedCodes = [];
        
        // Donn√©es de vote (stockage temporaire)
        let votes = JSON.parse(localStorage.getItem('votes')) || Array(candidates.length).fill(0);
        let selectedCandidate = null;
        let currentCode = null;

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            generateCandidates();
            
            // √âv√©nement pour valider le code
            document.getElementById('validateCode').addEventListener('click', validateCode);
            document.getElementById('voteCode').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') validateCode();
            });
            
            // √âv√©nements pour le vote
            document.getElementById('submitVote').addEventListener('click', showVoteConfirmation);
            document.getElementById('confirmVote').addEventListener('click', submitVote);
            document.getElementById('cancelVote').addEventListener('click', cancelVote);
            
            // √âv√©nement pour retourner au vote
            document.getElementById('backToVote').addEventListener('click', function() {
                document.getElementById('resultsSection').style.display = 'none';
                document.getElementById('codeSection').style.display = 'block';
            });
            
            // V√©rifier si l'utilisateur a d√©j√† vot√©
            if (localStorage.getItem('hasVoted') === 'true') {
                showResults();
            }
        });

        function validateCode() {
            const codeInput = document.getElementById('voteCode');
            const code = codeInput.value.trim().toUpperCase();
            const alertCode = document.getElementById('alertCode');
            const alertSuccess = document.getElementById('alertSuccess');
            
            // Masquer les alertes pr√©c√©dentes
            alertCode.style.display = 'none';
            alertSuccess.style.display = 'none';
            
            if (!code) {
                alertCode.textContent = 'Veuillez entrer un code de vote';
                alertCode.style.display = 'block';
                return;
            }
            
            // V√©rifier si le code est valide
            if (!validCodes.includes(code)) {
                alertCode.textContent = 'Code invalide. Veuillez v√©rifier votre code.';
                alertCode.style.display = 'block';
                return;
            }
            
            // V√©rifier si le code a d√©j√† √©t√© utilis√©
            if (usedCodes.includes(code)) {
                alertCode.textContent = 'Ce code a d√©j√† √©t√© utilis√© pour voter.';
                alertCode.style.display = 'block';
                return;
            }
            
            // Code valide
            currentCode = code;
            alertSuccess.style.display = 'block';
            
            // Animation de transition
            setTimeout(() => {
                document.getElementById('codeSection').style.display = 'none';
                document.getElementById('votingSection').style.display = 'block';
                alertSuccess.style.display = 'none';
            }, 1500);
        }

        function generateCandidates() {
            const container = document.getElementById('candidatesContainer');
            container.innerHTML = '';
            
            candidates.forEach((candidate, index) => {
                const card = document.createElement('div');
                card.className = 'candidate-card';
                card.dataset.id = candidate.id;
                card.innerHTML = `
                    <div class="candidate-number">${index + 1}</div>
                    <div class="candidate-name">${candidate.name}</div>
                    <div class="candidate-party">${candidate.party}</div>
                    <div class="candidate-description">${candidate.description}</div>
                `;
                
                card.addEventListener('click', function() {
                    selectCandidate(candidate.id);
                });
                
                container.appendChild(card);
            });
        }

        function selectCandidate(candidateId) {
            // D√©s√©lectionner tous les candidats
            document.querySelectorAll('.candidate-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // S√©lectionner le candidat choisi
            const selectedCard = document.querySelector(`.candidate-card[data-id="${candidateId}"]`);
            selectedCard.classList.add('selected');
            
            selectedCandidate = candidateId;
            
            // Mettre √† jour l'affichage de confirmation
            const candidate = candidates.find(c => c.id === candidateId);
            document.getElementById('selectedCandidateName').textContent = `${candidate.name} (${candidate.party})`;
        }

        function showVoteConfirmation() {
            const alertVote = document.getElementById('alertVote');
            
            if (!selectedCandidate) {
                alertVote.style.display = 'block';
                return;
            }
            
            document.getElementById('voteConfirm').style.display = 'block';
            document.getElementById('submitVote').style.display = 'none';
        }

        function cancelVote() {
            document.getElementById('voteConfirm').style.display = 'none';
            document.getElementById('submitVote').style.display = 'block';
        }

        function submitVote() {
            if (!selectedCandidate || !currentCode) return;
            
            // Afficher le loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('votingSection').style.display = 'none';
            
            // Simuler un traitement s√©curis√©
            setTimeout(() => {
                // Enregistrer le vote
                votes[selectedCandidate - 1]++;
                localStorage.setItem('votes', JSON.stringify(votes));
                
                // Marquer le code comme utilis√©
                usedCodes.push(currentCode);
                
                // Marquer l'utilisateur comme ayant vot√©
                localStorage.setItem('hasVoted', 'true');
                
                // Cacher le loading et afficher les r√©sultats
                document.getElementById('loading').style.display = 'none';
                showResults();
                
                // Afficher une notification de succ√®s
                const candidate = candidates.find(c => c.id === selectedCandidate);
                alert(`‚úÖ Vote enregistr√© avec succ√®s pour ${candidate.name} !`);
                
                // R√©initialiser pour un nouveau vote
                selectedCandidate = null;
                currentCode = null;
                document.getElementById('voteCode').value = '';
            }, 2000);
        }

        function showResults() {
            // Calculer les totaux et pourcentages
            const totalVotes = votes.reduce((a, b) => a + b, 0);
            
            // G√©n√©rer le tableau de r√©sultats
            const resultsBody = document.getElementById('resultsBody');
            resultsBody.innerHTML = '';
            
            candidates.forEach((candidate, index) => {
                const voteCount = votes[index];
                const percentage = totalVotes > 0 ? ((voteCount / totalVotes) * 100).toFixed(1) : 0;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><strong>${candidate.name}</strong></td>
                    <td>${candidate.party}</td>
                    <td>${voteCount}</td>
                    <td>${percentage}%</td>
                    <td>
                        <div class="vote-progress">
                            <div class="vote-progress-bar" style="width: ${percentage}%"></div>
                        </div>
                    </td>
                `;
                resultsBody.appendChild(row);
            });
            
            // G√©n√©rer un graphique simple avec Canvas
            const chart = document.getElementById('resultsChart');
            chart.innerHTML = '<canvas id="voteChart" width="400" height="400"></canvas>';
            
            if (typeof Chart !== 'undefined') {
                const ctx = document.getElementById('voteChart').getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: candidates.map(c => c.name),
                        datasets: [{
                            label: 'Nombre de votes',
                            data: votes,
                            backgroundColor: [
                                '#3498db', '#2ecc71', '#e74c3c', '#f39c12', '#9b59b6',
                                '#1abc9c', '#d35400', '#c0392b', '#16a085', '#8e44ad'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        }
                    }
                });
            }
            
            // Afficher la section des r√©sultats
            document.getElementById('codeSection').style.display = 'none';
            document.getElementById('votingSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';
            
            // Mettre √† jour le titre avec le total
            document.querySelector('#resultsSection .section-title').textContent = 
                `R√©sultats du Vote (${totalVotes} votes enregistr√©s)`;
        }

        // Ajouter Chart.js pour les graphiques
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/chart.js';
        document.head.appendChild(script);
    </script>
</body>
</html>