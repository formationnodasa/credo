<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üó≥Ô∏è VOTE INSTANT - √âcrit VOTE pour voter !</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        /* Header */
        .header {
            text-align: center;
            padding: 40px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .title {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
        }
        
        /* Main Voting Area */
        .vote-box {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .code-display {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 3px dashed #dee2e6;
        }
        
        .code-text {
            font-family: 'Courier New', monospace;
            font-size: 2.5rem;
            font-weight: bold;
            color: #2c3e50;
            letter-spacing: 10px;
            margin: 10px 0;
        }
        
        .vote-input-container {
            margin: 40px 0;
        }
        
        .vote-input {
            font-size: 3rem;
            padding: 20px;
            width: 300px;
            text-align: center;
            border: 4px solid #ddd;
            border-radius: 15px;
            font-weight: bold;
            letter-spacing: 5px;
            text-transform: uppercase;
            margin-bottom: 20px;
            transition: all 0.3s;
        }
        
        .vote-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
            transform: scale(1.05);
        }
        
        .vote-button {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            display: block;
            margin: 0 auto;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .vote-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(46, 204, 113, 0.4);
        }
        
        .vote-button:active {
            transform: translateY(-2px);
        }
        
        /* Timer */
        .timer-container {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin: 30px 0;
        }
        
        .timer {
            font-size: 4rem;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        /* Results */
        .results-box {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-top: 30px;
            color: #2c3e50;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .results-title {
            font-size: 2rem;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .result-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }
        
        .result-item:hover {
            transform: translateX(10px);
            background: #e9ecef;
        }
        
        .vote-count {
            background: #667eea;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            min-width: 60px;
            text-align: center;
        }
        
        /* Live Results */
        .live-results {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            padding: 15px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
            border-top: 3px solid #2ecc71;
        }
        
        .live-stat {
            text-align: center;
        }
        
        .live-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2ecc71;
        }
        
        .live-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        /* Instructions */
        .instructions {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .instructions h3 {
            margin-bottom: 15px;
            color: #ffd700;
        }
        
        /* Alert */
        .alert {
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            display: none;
            animation: pulse 0.5s;
            text-align: center;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.9); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .alert-success {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 2px solid #2ecc71;
        }
        
        .alert-error {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 2px solid #e74c3c;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .title { font-size: 2rem; }
            .vote-input { width: 100%; font-size: 2rem; }
            .timer { font-size: 2.5rem; }
            .live-results { flex-direction: column; gap: 10px; }
            .code-text { font-size: 1.8rem; letter-spacing: 5px; }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        /* Confetti */
        .confetti {
            position: fixed;
            width: 15px;
            height: 15px;
            background: #f00;
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 class="title">üó≥Ô∏è VOTE INSTANT</h1>
            <p class="subtitle">√âcrivez "VOTE" en majuscules pour voter une seule fois !</p>
        </div>
        
        <!-- Code Display -->
        <div class="vote-box fade-in">
            <div class="code-display">
                <h3 style="color: #666; margin-bottom: 15px;">VOTER AVEC LE CODE :</h3>
                <div class="code-text" id="currentCode">K7P4J9M2N6</div>
                <p style="color: #888; font-size: 0.9rem;">
                    Ce code change toutes les 24 heures
                </p>
            </div>
            
            <!-- Alert Message -->
            <div class="alert" id="alertMessage"></div>
            
            <!-- Vote Input -->
            <div class="vote-input-container">
                <input type="text" 
                       class="vote-input" 
                       id="voteInput"
                       maxlength="4"
                       placeholder="VOTE"
                       autocomplete="off"
                       autocapitalize="characters"
                       autofocus>
                <p style="color: #666; margin-top: 10px;">
                    √âcrivez exactement "<strong style="color: #2c3e50;">VOTE</strong>" en majuscules
                </p>
            </div>
            
            <!-- Vote Button -->
            <button class="vote-button" onclick="validateVote()">
                ‚úÖ VALIDER LE VOTE
            </button>
        </div>
        
        <!-- Timer -->
        <div class="timer-container fade-in">
            <h3 style="text-align: center; margin-bottom: 20px; color: #ffd700;">
                ‚è∞ TEMPS RESTANT POUR VOTER
            </h3>
            <div class="timer" id="timer">24:00:00</div>
            <p style="text-align: center; margin-top: 15px; opacity: 0.8;">
                Prochain code dans : <span id="nextCodeTime">24h00m</span>
            </p>
        </div>
        
        <!-- Results -->
        <div class="results-box fade-in">
            <h3 class="results-title">üìä R√âSULTATS EN DIRECT</h3>
            <div id="resultsContainer">
                <!-- Les r√©sultats seront ajout√©s ici -->
            </div>
        </div>
        
        <!-- Instructions -->
        <div class="instructions fade-in">
            <h3>üìù COMMENT VOTER :</h3>
            <ol style="margin-left: 20px; line-height: 2;">
                <li>Regardez le code en haut de la page</li>
                <li>√âcrivez <strong>"VOTE"</strong> en majuscules dans le champ</li>
                <li>Cliquez sur "VALIDER LE VOTE"</li>
                <li>Votre vote est enregistr√© √† vie !</li>
            </ol>
            <p style="margin-top: 15px; color: #ffd700; font-weight: bold;">
                ‚ö†Ô∏è Vous ne pouvez voter qu'une seule fois par code !
            </p>
        </div>
    </div>
    
    <!-- Live Results Bar -->
    <div class="live-results">
        <div class="live-stat">
            <div class="live-value" id="totalVotes">0</div>
            <div class="live-label">VOTES</div>
        </div>
        <div class="live-stat">
            <div class="live-value" id="activeCode">K7P4J9M2N6</div>
            <div class="live-label">CODE ACTUEL</div>
        </div>
        <div class="live-stat">
            <div class="live-value" id="timeLeft">24:00:00</div>
            <div class="live-label">TEMPS RESTANT</div>
        </div>
    </div>

    <!-- JavaScript SIMPLE et EFFICACE -->
    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
        
        // Codes valides (change toutes les 24h)
        const VOTE_CODES = [
            "K7P4J9M2N6", "Q1R8S3T5V9", "W2X4Y6Z7B8", "C3D5F7G9H2", "J4K6L8M1N3",
            "P5Q7R9S2T4", "V6W8X1Y3Z5", "B7C9D2F4G6", "H8J1K3L5M7", "N9P2Q4R6S8"
        ];
        
        // Candidats
        const CANDIDATES = [
            { id: 1, name: "Marie DUBOIS", color: "#3498db" },
            { id: 2, name: "Jean MARTIN", color: "#2ecc71" },
            { id: 3, name: "Sophie BERNARD", color: "#e74c3c" },
            { id: 4, name: "Thomas LEROY", color: "#f39c12" },
            { id: 5, name: "Camille PETIT", color: "#9b59b6" },
            { id: 6, name: "Alexandre MOREAU", color: "#1abc9c" },
            { id: 7, name: "Julie FONTAINE", color: "#d35400" },
            { id: 8, name: "Mohamed ALI", color: "#34495e" },
            { id: 9, name: "Isabelle LAMBERT", color: "#27ae60" },
            { id: 10, name: "Pierre GARNIER", color: "#8e44ad" }
        ];
        
        // ============================================
        // √âTAT GLOBAL
        // ============================================
        
        let currentCodeIndex = 0;
        let totalSeconds = 24 * 60 * 60; // 24 heures
        let timerInterval = null;
        let hasVoted = false;
        
        // ============================================
        // INITIALISATION
        // ============================================
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log("üöÄ Syst√®me VOTE INSTANT pr√™t !");
            
            // R√©cup√©rer ou cr√©er les donn√©es
            initializeData();
            
            // Configurer le code actuel
            setupCurrentCode();
            
            // D√©marrer le timer
            startTimer();
            
            // Charger les r√©sultats
            loadResults();
            
            // Focus sur l'input
            document.getElementById('voteInput').focus();
            
            // √âv√©nement Entr√©e
            document.getElementById('voteInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    validateVote();
                }
            });
            
            // Forcer majuscules
            document.getElementById('voteInput').addEventListener('input', function(e) {
                this.value = this.value.toUpperCase().slice(0, 4);
            });
        });
        
        // ============================================
        // FONCTIONS PRINCIPALES
        // ============================================
        
        function initializeData() {
            // Cr√©er les donn√©es si elles n'existent pas
            if (!localStorage.getItem('voteSystemData')) {
                const initialData = {
                    votes: {},
                    usedCodes: {},
                    totalVotes: 0,
                    startTime: Date.now()
                };
                localStorage.setItem('voteSystemData', JSON.stringify(initialData));
            }
            
            // V√©rifier si l'utilisateur a d√©j√† vot√©
            const userKey = getCurrentCode() + '_' + getDeviceId();
            const data = getData();
            if (data.usedCodes[userKey]) {
                hasVoted = true;
                showAlert('‚ö†Ô∏è Vous avez d√©j√† vot√© avec ce code !', 'error');
            }
        }
        
        function setupCurrentCode() {
            // D√©terminer le code actuel bas√© sur la date
            const now = new Date();
            const dayOfYear = Math.floor((now - new Date(now.getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);
            currentCodeIndex = dayOfYear % VOTE_CODES.length;
            
            const currentCode = VOTE_CODES[currentCodeIndex];
            
            // Mettre √† jour l'affichage
            document.getElementById('currentCode').textContent = currentCode;
            document.getElementById('activeCode').textContent = currentCode;
            
            // V√©rifier si le code a chang√©
            const lastCode = localStorage.getItem('lastVoteCode');
            if (lastCode !== currentCode) {
                // Nouveau code, r√©initialiser le timer
                totalSeconds = 24 * 60 * 60;
                localStorage.setItem('lastVoteCode', currentCode);
                localStorage.setItem('codeStartTime', Date.now());
            } else {
                // Calculer le temps restant
                const startTime = parseInt(localStorage.getItem('codeStartTime') || Date.now());
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                totalSeconds = Math.max(0, 24 * 60 * 60 - elapsed);
            }
        }
        
        function validateVote() {
            if (hasVoted) {
                showAlert('Vous avez d√©j√† vot√© avec ce code !', 'error');
                return;
            }
            
            const voteText = document.getElementById('voteInput').value.trim();
            
            // V√©rifier si c'est bien "VOTE"
            if (voteText !== 'VOTE') {
                showAlert('‚ùå Vous devez √©crire "VOTE" en majuscules !', 'error');
                createErrorAnimation();
                return;
            }
            
            // V√©rifier la longueur
            if (voteText.length !== 4) {
                showAlert('‚ùå Exactement 4 lettres : V-O-T-E', 'error');
                return;
            }
            
            // SUCC√àS ! Enregistrer le vote
            registerVote();
        }
        
        function registerVote() {
            // G√©n√©rer un vote al√©atoire (pour la d√©mo)
            const randomCandidate = CANDIDATES[Math.floor(Math.random() * CANDIDATES.length)];
            
            // Enregistrer les donn√©es
            const data = getData();
            const userKey = getCurrentCode() + '_' + getDeviceId();
            
            // V√©rifier double vote
            if (data.usedCodes[userKey]) {
                showAlert('‚ö†Ô∏è Vous avez d√©j√† vot√© !', 'error');
                hasVoted = true;
                return;
            }
            
            // Enregistrer le vote
            data.usedCodes[userKey] = {
                candidate: randomCandidate.id,
                timestamp: Date.now(),
                code: getCurrentCode()
            };
            
            // Incr√©menter les votes du candidat
            if (!data.votes[randomCandidate.id]) {
                data.votes[randomCandidate.id] = 0;
            }
            data.votes[randomCandidate.id]++;
            data.totalVotes++;
            
            // Sauvegarder
            saveData(data);
            
            // Marquer comme ayant vot√©
            hasVoted = true;
            
            // Effacer l'input
            document.getElementById('voteInput').value = '';
            
            // Afficher succ√®s
            showAlert(`‚úÖ VOTE ENREGISTR√â ! Pour ${randomCandidate.name}`, 'success');
            
            // Animation de confetti
            createConfetti();
            
            // Mettre √† jour les r√©sultats
            loadResults();
            
            // Bloquer le champ
            document.getElementById('voteInput').disabled = true;
            
            // Message final
            setTimeout(() => {
                showAlert('üéâ Merci pour votre participation ! Votre vote est enregistr√© √† vie.', 'success');
            }, 1000);
        }
        
        // ============================================
        // TIMER ET CHRONOM√àTRE
        // ============================================
        
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            
            timerInterval = setInterval(() => {
                if (totalSeconds > 0) {
                    totalSeconds--;
                    updateTimerDisplay();
                    
                    // V√©rifier si le temps est √©coul√©
                    if (totalSeconds === 0) {
                        codeExpired();
                    }
                }
            }, 1000);
            
            updateTimerDisplay();
        }
        
        function updateTimerDisplay() {
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;
            
            const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            document.getElementById('timer').textContent = timeString;
            document.getElementById('timeLeft').textContent = timeString;
            
            // Calculer le temps du prochain code
            const nextHours = (hours === 0 && minutes === 0 && seconds === 0) ? 24 : hours;
            document.getElementById('nextCodeTime').textContent = `${nextHours}h${minutes.toString().padStart(2, '0')}m`;
        }
        
        function codeExpired() {
            showAlert('üîÑ Code expir√© ! Nouveau code g√©n√©r√©.', 'success');
            
            // Changer de code
            currentCodeIndex = (currentCodeIndex + 1) % VOTE_CODES.length;
            setupCurrentCode();
            
            // R√©initialiser le vote
            hasVoted = false;
            document.getElementById('voteInput').disabled = false;
            document.getElementById('voteInput').focus();
            
            // Red√©marrer le timer
            totalSeconds = 24 * 60 * 60;
            startTimer();
        }
        
        // ============================================
        // R√âSULTATS
        // ============================================
        
        function loadResults() {
            const data = getData();
            const container = document.getElementById('resultsContainer');
            const totalVotesElement = document.getElementById('totalVotes');
            
            // Mettre √† jour le total
            totalVotesElement.textContent = data.totalVotes;
            
            // Trier les candidats par votes
            const sortedCandidates = [...CANDIDATES].sort((a, b) => {
                const votesA = data.votes[a.id] || 0;
                const votesB = data.votes[b.id] || 0;
                return votesB - votesA;
            });
            
            // Afficher les r√©sultats
            container.innerHTML = '';
            
            sortedCandidates.forEach(candidate => {
                const votes = data.votes[candidate.id] || 0;
                const percentage = data.totalVotes > 0 ? ((votes / data.totalVotes) * 100).toFixed(1) : 0;
                
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item';
                resultItem.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div style="width: 40px; height: 40px; border-radius: 50%; background: ${candidate.color}; 
                                    display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                            ${candidate.id}
                        </div>
                        <div>
                            <strong style="color: #2c3e50;">${candidate.name}</strong>
                            <div style="display: flex; align-items: center; gap: 10px; margin-top: 5px;">
                                <div style="width: 150px; height: 10px; background: #e0e0e0; border-radius: 5px; overflow: hidden;">
                                    <div style="width: ${percentage}%; height: 100%; background: ${candidate.color};"></div>
                                </div>
                                <span style="color: #666; font-size: 0.9rem;">${percentage}%</span>
                            </div>
                        </div>
                    </div>
                    <div class="vote-count">${votes}</div>
                `;
                
                container.appendChild(resultItem);
            });
        }
        
        // ============================================
        // UTILITAIRES
        // ============================================
        
        function getData() {
            return JSON.parse(localStorage.getItem('voteSystemData') || '{}');
        }
        
        function saveData(data) {
            localStorage.setItem('voteSystemData', JSON.stringify(data));
        }
        
        function getCurrentCode() {
            return VOTE_CODES[currentCodeIndex];
        }
        
        function getDeviceId() {
            // G√©n√©rer un ID unique pour l'appareil
            let deviceId = localStorage.getItem('deviceId');
            if (!deviceId) {
                deviceId = 'device_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('deviceId', deviceId);
            }
            return deviceId;
        }
        
        function showAlert(message, type) {
            const alert = document.getElementById('alertMessage');
            alert.textContent = message;
            alert.className = `alert alert-${type}`;
            alert.style.display = 'block';
            
            // Auto-masquage
            setTimeout(() => {
                alert.style.display = 'none';
            }, type === 'success' ? 5000 : 3000);
        }
        
        function createErrorAnimation() {
            const input = document.getElementById('voteInput');
            input.style.borderColor = '#e74c3c';
            input.style.boxShadow = '0 0 20px rgba(231, 76, 60, 0.5)';
            
            setTimeout(() => {
                input.style.borderColor = '#ddd';
                input.style.boxShadow = 'none';
            }, 500);
        }
        
        function createConfetti() {
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.top = '-20px';
                    confetti.style.background = `hsl(${Math.random() * 360}, 100%, 50%)`;
                    confetti.style.opacity = '1';
                    document.body.appendChild(confetti);
                    
                    // Animation
                    const animation = confetti.animate([
                        { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                        { transform: `translateY(${window.innerHeight}px) rotate(${Math.random() * 720}deg)`, opacity: 0 }
                    ], {
                        duration: 1000 + Math.random() * 2000,
                        easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
                    });
                    
                    animation.onfinish = () => confetti.remove();
                }, i * 20);
            }
        }
        
        // ============================================
        // SAUVEGARDE AUTOMATIQUE
        // ============================================
        
        // Sauvegarder avant fermeture
        window.addEventListener('beforeunload', function() {
            const data = getData();
            data.lastSave = Date.now();
            saveData(data);
        });
        
        // Sauvegarde p√©riodique
        setInterval(() => {
            const data = getData();
            data.autoSave = Date.now();
            saveData(data);
        }, 30000); // Toutes les 30 secondes
        
        console.log("‚úÖ Syst√®me pr√™t ! Testez en √©crivant 'VOTE'");
    </script>
</body>
</html>